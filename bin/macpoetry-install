#!/bin/bash

echo "Begin Mac specific build script (bin/macpoetry-install)."

CFLAGS="-I$(brew --prefix zlib)/include" LDFLAGS="-L$(brew --prefix zlib)/lib" poetry install

if [[ `uname -o` == "Darwin" && `uname -m` == "arm64" ]] ; then
    #
    # These worked around Mac M1 issues (after the build) running (at least) make deploy1a.
    #
    echo "Some post poetry install special installs for Mac M1."
    pip uninstall -y pytabix
    pip install pytabix
    echo "Done with post poetry install special installs for Mac M1."
fi

echo "End Mac specific build script (bin/macpoetry-install)."
